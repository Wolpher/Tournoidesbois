{"version":3,"file":"index.js","names":["useEffect","useRef","useCallback","invariant","maxHorizontalScroll","dom","scrollWidth","clientWidth","maxVerticalScroll","scrollHeight","clientHeight","domRef","onDragStart","onDragEnd","runScroll","dx","dy","offsetX","Math","min","current","scrollLeft","offsetY","scrollTop","internalState","lastMouseX","lastMouseY","isMouseDown","isScrolling","scroll","process","env","NODE_ENV","onMouseDown","e","clientX","clientY","onMouseUp","onMouseMove","window","addEventListener","removeEventListener","events"],"sources":["../src/index.js"],"sourcesContent":["import { useEffect, useRef, useCallback } from 'react';\nimport invariant from 'tiny-invariant';\n\nconst maxHorizontalScroll = (dom) => dom.scrollWidth - dom.clientWidth;\nconst maxVerticalScroll = (dom) => dom.scrollHeight - dom.clientHeight;\n\nexport default (domRef, {\n  onDragStart = () => {},\n  onDragEnd = () => {},\n  runScroll = ({ dx, dy }) => {\n    const offsetX = Math.min(maxHorizontalScroll(domRef.current), domRef.current.scrollLeft + dx);\n    domRef.current.scrollLeft = offsetX; // eslint-disable-line no-param-reassign\n\n    const offsetY = Math.min(maxVerticalScroll(domRef.current), domRef.current.scrollTop + dy);\n    domRef.current.scrollTop = offsetY; // eslint-disable-line no-param-reassign\n  },\n} = {}) => {\n  const internalState = useRef({\n    lastMouseX: null,\n    lastMouseY: null,\n    isMouseDown: false,\n    isScrolling: false,\n  });\n\n  const scroll = useCallback(({ dx, dy }) => {\n    invariant(domRef.current !== null, `Trying to scroll to the bottom, but no element was found.\n      Did you call this scrollBottom before the component with this hook finished mounting?`);\n\n    runScroll({ dx, dy });\n  }, [runScroll]);\n\n  const onMouseDown = useCallback((e) => {\n    internalState.current.isMouseDown = true;\n    internalState.current.lastMouseX = e.clientX;\n    internalState.current.lastMouseY = e.clientY;\n  }, []);\n\n  const onMouseUp = () => {\n    internalState.current.isMouseDown = false;\n    internalState.current.lastMouseX = null;\n    internalState.current.lastMouseY = null;\n\n    if (internalState.current.isScrolling) {\n      internalState.current.isScrolling = false;\n      onDragEnd();\n    }\n  };\n\n  const onMouseMove = (e) => {\n    if (!internalState.current.isMouseDown) {\n      return;\n    }\n\n    if (!internalState.current.isScrolling) {\n      internalState.current.isScrolling = true;\n      onDragStart();\n    }\n\n    // diff is negative because we want to scroll in the opposite direction of the movement\n    const dx = -(e.clientX - internalState.current.lastMouseX);\n    const dy = -(e.clientY - internalState.current.lastMouseY);\n    internalState.current.lastMouseX = e.clientX;\n    internalState.current.lastMouseY = e.clientY;\n\n    scroll({ dx, dy });\n  };\n\n  useEffect(() => {\n    window.addEventListener('mouseup', onMouseUp);\n    window.addEventListener('mousemove', onMouseMove);\n\n    return () => {\n      window.removeEventListener('mouseup', onMouseUp);\n      window.removeEventListener('mousemove', onMouseMove);\n    };\n  }, []);\n\n  return {\n    events: {\n      onMouseDown,\n    },\n  };\n};\n"],"mappings":"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","ignoreList":[]}